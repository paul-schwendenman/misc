#! /bin/bash

version () {
	cat <<_EOF
 ___________________
/   Set up          \ 
|      v0.2.1       |
|                   |
\ Paul Schwendenman /
 -------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\ 
                ||----w |
                ||     ||
_EOF

}

usage() {
	version
	cat <<_EOF

Usage:
    $program all
        Copy all config files
    $program bash
    	Copy bashrc
    $program git
        Copy git config
    $program hg
    	Copy mercurial rc file.
    $program screen
    	Copy screen rc file.
    $program diff [hg|git|bash|all]
    	Show differences in config files
    $program help
        Show this text.
    $program version
        Show version information.

More information?
_EOF
}

is_command() {
	case "$1" in
		all|screen|bash|git|hg|diff|help|--help|version|--version) return 0 ;;
		*) return 1 ;;
	esac
}

conf_bash () {
	echo "Configuring bash"
	cp dotfiles/bashrc $HOME/.bashrc
}

conf_git () {
	echo "Configuring git"
	cp dotfiles/gitconfig $HOME/.gitconfig
}

conf_hg () {
	echo "Configuring mercurial"
	cp dotfiles/hgrc $HOME/.hgrc
}

conf_screen () {
	echo "Configuring screen"
	cp dotfiles/screenrc $HOME/.screenrc
}

conf_diff () {
	case "$1" in
		bash)
			diff dotfiles/bashrc $HOME/.bashrc
			exit 0
			;;
		git)
			diff dotfiles/gitconfig $HOME/.gitconfig
			exit 0
			;;
		hg)
			diff dotfiles/hgrc $HOME/.hgrc
			exit 0
			;;
		all)
			echo "[bash]"
			diff dotfiles/bashrc $HOME/.bashrc
			echo "[git]"
			diff dotfiles/gitconfig $HOME/.gitconfig
			echo "[hg]"
			diff dotfiles/hgrc $HOME/.hgrc
			;;
		*)
			echo "Try bash|git|hg|all"
			exit 1
			;;
	esac
}

program="$(basename "$0")"
command="$1"

if is_command "$command"; then
	shift
else
	command="all"
fi

case "$command" in
	all)
		conf_bash
		conf_git
		conf_hg
		conf_screen
		exit 0
		;;
	bash)
		conf_bash
		exit 0
		;;
	git)
		conf_git
		exit 0
		;;
	hg)
		conf_hg
		exit 0
		;;
	screen)
		conf_screen
		exit 0
		;;
	diff)
		conf_diff $1
		exit 0
		;;
	help|--help)
		usage
		;;
	version|--version)
		version
		exit 0
		;;
	*)
		usage
		exit 1
		;;
esac
